Accessing BLOB Data from External Systems Using Business Connectivity Services in SharePoint Server 2010 Learn how to use Microsoft Business Connectivity Services (BCS) in Microsoft SharePoint Server 2010 to access and surface BLOB data in the SharePoint user interface and search Microsoft Business Connectivity Services (BCS) is the new version of Microsoft Office SharePoint Server 2007 Business Data Catalog functionality. New features are added that help retrieve binary large object data (referred to as BLOB data) from external systems and make it available in Microsoft SharePoint Server 2010. This article describes the following The functionality that is provided by the StreamAccessor stereotype that is introduced in Business Connectivity Services How to use StreamAccessor to retrieve file attachments from external systems for viewing and indexing How to write the BDC model that is required to consume BLOB data The built-in Web Parts behavior for BLOB data, and how BLOB fields can be indexed by SharePoint Server search In this article's scenario, the AdventureWorks database that is hosted in Microsoft SQL Server 2008 is used as an external system that contains the binary data. The BDC metadata model is created with a StreamAccessorMethodInstance to retrieve the BLOB field of type varbinary from SQL Server as an external content type. The BLOB fields are modeled as types that can be read in chunks to help Business Connectivity Services read the stream in chunks, and not load the complete content in memory. This can help prevent out-of-memory conditions. An example of such a type is System.IO.Stream in the Microsoft .NET Framework. An External Data Grid Web Part is configured to show the external items with links to download the BLOB. Finally, Search is configured to crawl the BLOBs and show the results in the SharePoint Server search user interface (UI) Setting Up the Server Environment The following are the requirements to run this scenario Ensure that the following is installed on in your server environment This scenario uses the AdventureWorks sample database to represent the external system that contains BLOB data. To download the x64 version of the AdventureWorks sample database from Codeplex Run the Setup program to create the database The Production Document table is used to model the external content type that contains the BLOB field. The Document column contains Microsoft Word documents stored as varbinary data types in the table The first step in this scenario is to set up the Business Connectivity Services infrastructure in the SharePoint environment. This step includes setting up the Business Connectivity Services service application, sites to host Business Connectivity Services Web Parts, and profile pages for the external content type Verify that the Business Data Connectivity (BDC) service is running. Create a BDC service application Give the account that is used to access the external content type read rights on the AdventureWorks database and on the Production.Document table. In this scenario, you use Passthrough as the authentication mechanism in the metadata model. Therefore, the identity of the user who is connecting to SharePoint is used to authenticate against the SQL Server external system If your deployment has the external system (SQL Server) installed on a server different from the SharePoint front-end web server, configure the Kerberos protocol for passing the end-user credentials, or use Secure Store Service to do a single sign-on into the external system Microsoft SharePoint Designer 2010 provides functionality to create external content types and save them or export them in a metadata model file. You must model the StreamAccessor stereotype manually because it cannot be modeled by using SharePoint Designer. To make things easier and to prepare the basic metadata, it is recommended that you use SharePoint Designer to create the initial metadata model that supports Create, Read, Update, and Delete (CRUD) operations. You can then do additional editing in a text editor such as Notepad or use any XML editor to add the StreamAccessor and any other method stereotypes that are not supported in SharePoint Designer In this scenario, you create the initial model by using SharePoint Designer, and then manually add the StreamAccessor stereotype by exporting the model and editing in Notepad or another XML editor Explore these links to find out more about developing solutions for SharePoint Foundation 2010, SharePoint Server 2010, and SharePoint Designer 2010 Microsoft SharePoint 2010 collaboration software provides enterprise-scale capabilities to meet business-critical needs such as managing content and business processes, simplifying how people find and share information across boundaries, and enabling informed decisions. Using the combined collaboration features of SharePoint 2010—which includes Microsoft SharePoint Foundation 2010 and Microsoft SharePoint Server 2010—plus the design and customization capabilities of Microsoft SharePoint Designer 2010, organizations can enable their users to create, manage, and easily build SharePoint sites that are discoverable throughout the organization The SharePoint Foundation 2010 technology helps teams stay connected and productive by providing easy access to the people, documents, and information that can help in decision making and getting work done. See Microsoft SharePoint Foundation 2010 for the free download of SharePoint Foundation 2010 SharePoint Server 2010 relies on the SharePoint Foundation 2010 technology to provide a consistent, familiar framework for lists and libraries, site administration, and site customization. Any features that are available in SharePoint Foundation 2010 are also available in SharePoint Server 2010